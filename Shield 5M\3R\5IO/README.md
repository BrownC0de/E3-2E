# Модуль из 5 мосфетов, 3 реле, и 5 вводов\выводов E3-2E 5M/3R/5IO

<img src="/Shield%205M%5C3R%5C5IO/photo_mosfet.jpg" width="1000">

Данный модуль состоит из 5 полевых транзисторов (мофсетов) 3х реле, и 5 дополнительных входов\выходов

И отлично подходит для управления светодиодным освещением. Например к нему можно подключить светодиодную ленты RGBWW, либо 5 отдельных одноцветных лент. 
Так же им отлично управляться моторы на 12вольт, к примеру для вытяжки, и благодаря подключению через мосфет можно регулировать скорость вращения. 
3 Реле позволяет так же подключить любой нагрузку, мощностью до 1100вт. 
А 5 дополнительных входов\выходов разные датчики (движения, присутствия, открытия дверь) или кнопки\включатели. Благодаря которым во первых получиться полностью автоматизировать включение света. А во вторых подключить обычные включатели, оставив привычную возможность управлять светом в ручную.

*Так же упомяну и здесь - имейте ввиду, реле на 5а это максимум 1100вт, а у некоторых не сильно качественных светодиодных лампочек может быть очень высокий пусковой ток. Встречаются экземпляры у которых он превышает 100к1 от номинального потребления. То есть 15 вт лампочка, при включении потребляет 1500вт. Да, этот момент очень кратковременный, но этого времени достаточно что бы реле приказало долго жить. Рекомендую использовать качественные лампы, например у Икеи стартовые токи не превышают 5к1 от номинала, и в целом они отлично себя зарекомендовали.*

<img src="/MainBoard/images/Shield_2.png" width="600">

#### Особенности:
- 3 Реле по 5а (1100вт максимум)
- 5 Мосфетов, для диммирования светодиодных лент, или регулировки оборотов у моторов
- 5 Портов входа\выхода с возможностью подтяжки pulldown к резисторам в 10к
- Для работы использует порт I2c-Shiled и GPIO-Shield c основной платы. 
- Выходы 2,4,12,14,15 с основной платы - используются мосфетами. На них лучше нечего больше не подключать. 

*Подтяжка внешним резистором нужна для стабильной работы датчиков и кнопок\включателей на больших расстояниях.*

### Пример использования

- [На кухне в квартире](/cases/kitchen.md). Управлене освещением, вентиляцией, контроль протечек, снятие показаний с счетчиков воды, и кое что еще :)
- [В бане или сауне](/cases/sauna.md) Управление освещением, контроль температуры и влажности в парилке, комнате отдыха, температура воды в баке, а так же датчики дыма и угарного газа.
 
<img src="/Shield%205M%5C3R%5C5IO/PCB.png" width="600">
Некоторые пояснения.

- P3, С3 - Клемники порты ввода\вывода, с возможностью подключения подтяжки резистором 10к к земле
- U2 - Вход для мосфетов, это же напряжение идет на выходе на клеммах P1, P2 
- С1, С19, С20 - Клемники для реле. 
-  Адрес I2c - 0x20
 

Перейдем к сборке.  
### Для заказа печатных плат на производстве

[Скачать GERBER](/Shield%205M%5C3R%5C5IO/Gerber_Shield_5M3R5IO.zip)

В Китае полно сервисов для печати плат, но я предпочитаю пользоваться [jlcpcb.com](https://jlcpcb.com/) поскольку: 
5 плат (это минималка) за 2-4 доллара + доставка, это совсем недорого, за печатные платы заводского исполнения. 
На других сервисах малые партии - дороже, но дешевле большие. 

### Схемотехника
<img src="/Shield%205M%5C3R%5C5IO/Schematic_E3-2e-5M_3R_5IO.png" width="1000">

***

Размеры и тип компонентов:
- K1, К7, К8 - Реле ALDP105W [Ali](https://aliexpress.ru/item/4001081126200.html),[ChipDip](https://www.chipdip.ru/product1/8003573908)
- U1 - PCF8574T 8 канальные расширители портов [Ali](https://aliexpress.ru/item/32964941533.html),[ChipDip](https://www.chipdip.ru/product/pcf8574t-3)
- D1 - Матрица Дарлингтона из восьми транзисторов [Ali](https://aliexpress.ru/item/32792767122.html),[ChipDip]
- U2 - Двойной клемник 5.0 [Ali],[ChipDip]
- P1, P2 - Тройные клемники 5.0 [Ali](https://aliexpress.ru/item/32861603911.html),[ChipDip]
- P3 - Тройной клемник 2.54 [Ali](https://aliexpress.ru/item/1005001894448937.html),[ChipDip]
- С1, C7, C19, C20 - Двойные клемники 2.54 [Ali](https://aliexpress.ru/item/1005001894448937.html),[ChipDip]
- Q1, Q2, Q3, Q4, Q5 - Мосфеты IRF3205 [Ali](https://aliexpress.ru/item/32511028751.html),[ChipDip]
- I2c-Shield Гребенка на 5 пинов, 2.54 [Ali](https://aliexpress.ru/item/32519474531.html),[ChipDip]
- GPIO-Shield Гребенка на 6 пинов, 2.54 [Ali](https://aliexpress.ru/item/32519474531.html),[ChipDip]
- R1, R2,R3,R5,R10 - Резисторы от 220 до 500 Ом, размером 0805 [Ali](https://aliexpress.ru/item/4000095368506.html),[ChipDip]
- R4, R6, R7, R8, R9, R11, R12 ,R13, R14, R20  - Резисторы 10к, в размере 0805 [Ali](https://aliexpress.ru/item/4000095368506.html),[ChipDip]
- J - Гребенка на 2 пина 2.54 с перемычкой [Ali](https://aliexpress.ru/item/32519474531.html),[ChipDip]
- J - Перемычка [Ali](https://aliexpress.ru/item/4001139171872.html), [ChipDip]

Для заказа компонентов: [Файл BOM](/MainBoard)

### Вариации при сборке:
Можно несколько упростить схему, если:
- Не нужна подтяжка? Убираем R4, R11, R12, R13, R14 и J
- Вместо мосфета IRF3205 можно паять IRF520

***

### Прошивка EspHome
Примеры конфигурационных файлов под эту плату ниже: 
- [YAML Универсальный](/Shield%205M%5C3R%5C5IO/Esphome.yaml)
- [YAML Кухня-Ванная](/cases/kitchen.md)
- [YAML Баня](/cases/sauna.md)

### Сборка платы
При пайке, у новичков могут быть сложности из-за использования smd компонентов в размерности 0805 и плотности их расположения.

Сначала паять микросхемы, потом резисторы, потом уже все остальное. Реле и мосфеты удобно паять в самом конце. 


