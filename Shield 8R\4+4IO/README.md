# Модуль на 8 реле и 8 входов/выходов E3-2E 8R/4+4IO

<img src="/Shield%208R%5C4%2B4IO/photo_8r.jpg" width="1000">

Модуль представляет из себя 8 реле, подключенных через расширитель портов, с защитой транзисторами. И 8 дополнительных портов ввода\вывода.

Данный модуль отлично себя зарекомендовал для:
- Управления освещением. С подключением слаботочными проводами к  обычным включателей.  
*Но имейте ввиду, реле на 5а - это максимум 1100вт , а у некоторых не сильно качественных светодиодных лампочек может быть очень высокий пусковой ток. Встречаються экземпляры у которых он превышает 100к1 от номинального потребления. То есть 15 вт лампочка, при включении потребляет 1500вт. Да, этот момоент очень кратковремнный, но этого времени достаточно что бы реле приказало долго жить. Рекомендую использовать качественные лампы, например у икеи стартовые токи не привышают 5к1 от номинала, и в целом они отлтично себя зарекомендовали*
- Управления отоплением. 
<img src="/MainBoard/images/Shield_1.png" width="600">
#### Основные характеристики:
- 2 Порта цифровых ввода\вывода 
- 2 Порта цифровых ввода\вывода с возможностью подтяжки внешним резистором на 10к
- 4 Порта с опторязвязкой
- 8 Реле по 5а (1100вт)
- Для работы использует порт I2c-Shiled c основной платы. 

*Подтяжка внешним резистором нужна для стабильной работы датчиков и кнопок\включателей на больших расстояниях.*

 
<img src="/Shield%208R%5C4%2B4IO/PCB.png" width="600">
Некоторые пояснения.

- С7, С12 - Клемники используемые сверху, порты ввыода\вывода, с подтяжкой резистором 10к
- С5, С6 - Клемники с подключаемой опторазвязкой. 
- C13-C20 - Клемники для для реле. 

Адресация I2c
- Блок с пинами ввода\вывода имеет адрес 0x20
- Блок с реле - адрес 0x21
 

Перейдем к сборке. 
### Схемотехника
<img src="/Shield%208R%5C4%2B4IO/Schematic_E3-2E-8R4+4IO.png" width="1000">

***

Размеры и тип компонентов:
- K1-K8 - Реле ALDP105W [Ali](https://aliexpress.ru/item/4001081126200.html),[ChipDip](https://www.chipdip.ru/product1/8003573908)
- U1-U2 - PCF8574T 8 канальные расширители портов [Ali](https://aliexpress.ru/item/32964941533.html),[ChipDip](https://www.chipdip.ru/product/pcf8574t-3)
- D1 - Матрица Дарлингтона из восьми транзисторов [Ali](https://aliexpress.ru/item/32792767122.html),[ChipDip]
- D3 - 4х канальная транзисторная оптопара TLP281-4GB [Ali](https://aliexpress.ru/item/4001304582657.html),[ChipDip]
- N1-N4 - Конденсаторы 0.1МкФ, размером 0805 [Ali](https://aliexpress.ru/item/32958102729.html),[ChipDip]
- R5-R8 - Резисторы номиналом 1к, размером 0805 [Ali](https://aliexpress.ru/item/4000095368506.html),[ChipDip]
- R1, R4 - Резисторы номиналом 10к, размерность 1206 (В следующей версии переделаю на 0805) [Ali_0805](https://aliexpress.ru/item/4000095368506.html),[ChipDip]
- С13-С20 - Двойные клемники, 2,54 [Ali](https://aliexpress.ru/item/1005001894448937.html),[ChipDip]
- С7, С12, С5, С6 - Двойные клемники, 2,54 [Ali](https://aliexpress.ru/item/1005001894448937.html),[ChipDip]
- J - Гребенка из 2х пинов 2,54 [Ali](https://aliexpress.ru/item/32519474531.html?&sku_id=57443157216),[ChipDip]
- H Гребенка из 3х пинов 2,54 [Ali](https://aliexpress.ru/item/32519474531.html?&sku_id=57443157216),[ChipDip]
- I2c-Shield - Порт "мама" для гребенки из 5 пинов 2,54 [Ali],[ChipDip]



Для заказа компонентов: [Файл BOM](/MainBoard)

### Вариации при сборке:
Можно несколько упростить схему, если:
- Не нужна опторазвязка? Не распаиваем D3, R5-R8, N1-N4. Гребенку H паять все равно нужно. 
- Не нужна подтяжка? Убираем R1, R4, J3, J4

***
<img src="/Shield%208R%5C4%2B4IO/photo_8r_2.jpg" width="1000">
### Прошивка EspHome. Примеры конфигураций

Универсальная конфигурация:
- [YAML](/Shield%208R%5C4%2B4IO/Esphome.yaml) 
- [BIN](/Shield%208R%5C4%2B4IO/e3-2e_8relay_01.bin)

Конфигурация под систему отопления
- YAML
- BIN

Бинарники приложены для быстрой прошивки, в дальнейшем, для более индивидуальной настройки рекомендую компилировать прошивку в EspHome самостоятельно.


### Сборка платы
При пайке, у новичков могут быть сложности из-за использования smd компонентов в размерности 0805 и плотности их расположения.

Сначала паять микросхемы, потом резисторы, потом уже все остальное. Реле что бы не мешалось паяеться в самом конце. 


